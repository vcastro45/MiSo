<template>
  <div class="eye" ref="eye">
		<svg ref="eye" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 644 321" style="enable-background:new 0 0 644 321;" xml:space="preserve">
		<path class="st0" d="M367.3,161.8l-1.6-4.7l-7.4-21.9c-0.1-0.3-0.3-0.5-0.5-0.7l-15.3-11.3c0,0,0,0,0,0l0,0l-0.6-0.5
			c-0.2-0.3-0.5-0.4-0.9-0.5l-28.1-3.3c-0.3,0-0.7,0-0.9,0.2l-16.5,10.7c0,0,0,0-0.1,0.1c0,0-0.1,0.1-0.1,0.1
			c-0.1,0.1-0.1,0.1-0.2,0.2c0,0,0,0-0.1,0.1l-18.2,30.3c0,0.1-0.1,0.1-0.1,0.2c0,0.1-0.1,0.1-0.1,0.2c0,0.1,0,0.2,0,0.3
			c0,0,0,0.1,0,0.1c0,0.2,0,0.3,0.1,0.5c0,0,0,0,0,0l12.1,27.6c0.1,0.2,0.3,0.4,0.5,0.6l5.4,3.8c0,0,0,0,0,0c0,0,0,0,0,0l16.6,10.6
			c0.2,0.1,0.5,0.2,0.8,0.2c0,0,0,0,0,0l28.9-0.6c0.1,0,0.1,0,0.1,0c0.1,0,0.2,0,0.3-0.1c0.1,0,0.1-0.1,0.2-0.1c0.1,0,0.1-0.1,0.2-0.1
			l12.6-10.1c0.2-0.2,0.3-0.4,0.4-0.6l11.8-29.9C367.3,163.1,367.5,162.4,367.3,161.8z"/>
		<g>
			<path class="st1" d="M339,146.4c-1.6-4.7-5.6-6.2-11.1-6.2c-3.4,0-7.3,0.6-11.6,1.3c-1.5,0.3-3,0.5-4.4,0.7
				c-3.8,0.5-6.8,3.3-8.3,7.7c-2.2,6.4-0.5,14.1,4,18.6c6.4,6.5,17.4,11.6,26.9,5C343.7,167,342,155.2,339,146.4z"/>
			<path class="st2" d="M341.7,145.4c-3.6-10.4-16-8.4-25.9-6.8c-1.5,0.2-3,0.5-4.4,0.7c-4.9,0.7-8.8,4.2-10.6,9.7
				c-2.5,7.4-0.6,16.2,4.6,21.5c5.9,5.9,12.7,8.9,19.1,8.9c4,0,7.9-1.2,11.4-3.6C344.5,169.9,346.5,159.4,341.7,145.4z M307.5,168.5
				c-4.5-4.5-6.1-12.1-4-18.6c1.5-4.4,4.5-7.2,8.3-7.7c1.4-0.2,2.9-0.4,4.4-0.7c4.3-0.7,8.2-1.3,11.6-1.3c5.5,0,9.5,1.5,11.1,6.2
				c3,8.8,4.7,20.6-4.6,27.1C324.8,180.1,313.9,174.9,307.5,168.5z"/>
			<path ref="pupil" class="st3" d="M316.4,162.6c-3.6-3-2.5-11.1,2.1-11.9c3.9-0.7,9.2-1.7,11.9,2.1c2.7,3.9,2.4,10.5-2.1,11.9
				C323.5,166.3,319.5,165.1,316.4,162.6z"/>
			<path class="st0" d="M305,155.5c-1.6-2.7,0.8-7.5,3.9-7c2.6,0.4,6.2,0.9,7,3.9c0.9,3-0.7,7.1-3.9,7
				C308.7,159.3,306.4,157.7,305,155.5z"/>
		</g>
		<path class="st2" d="M367.3,161.8l-1.6-4.7l-7.4-21.9c-0.1-0.3-0.3-0.5-0.5-0.7l-15.3-11.3c0,0,0,0,0,0l0,0l-0.6-0.5
			c-0.2-0.3-0.5-0.4-0.9-0.5l-28.1-3.3c-0.3,0-0.7,0-0.9,0.2l-16.5,10.7c0,0,0,0-0.1,0.1c0,0-0.1,0.1-0.1,0.1
			c-0.1,0.1-0.1,0.1-0.2,0.2c0,0,0,0-0.1,0.1l-18.2,30.3c0,0.1-0.1,0.1-0.1,0.2c0,0.1-0.1,0.1-0.1,0.2c0,0.1,0,0.2,0,0.3
			c0,0,0,0.1,0,0.1c0,0.2,0,0.3,0.1,0.5c0,0,0,0,0,0l12.1,27.6c0.1,0.2,0.3,0.4,0.5,0.6l5.4,3.8c0,0,0,0,0,0c0,0,0,0,0,0l16.6,10.6
			c0.2,0.1,0.5,0.2,0.8,0.2c0,0,0,0,0,0l28.9-0.6c0.1,0,0.1,0,0.1,0c0.1,0,0.2,0,0.3-0.1c0.1,0,0.1-0.1,0.2-0.1c0.1,0,0.1-0.1,0.2-0.1
			l12.6-10.1c0.2-0.2,0.3-0.4,0.4-0.6l11.8-29.9C367.3,163.1,367.5,162.4,367.3,161.8z M363.8,162.3l-20.7,21.2l-5.1-3.9l0,0l-13-10
			l-3.6-28.5l29-3.7L363.8,162.3z M360.1,149.4l-7.6-14.1l0,0c0-0.1-0.1-0.2-0.2-0.2l-2.2-2.6l5.7,4.2L360.1,149.4z M313.1,122l27,3.2
			l8.3,9.7l-28.5,3.6l-10.4-3.8l-10.1-3.7L313.1,122z M296.9,133l10.8,4l10.8,4l2.8,21.2l0.9,7.2l-17.5,4.4l0,0l-12.3,3.1l-1.9-2.3
			l-10.7-13L296.9,133z M291.3,188.3l-7.8-17.8l5.3,6.5l1.7,2.1l2.6,10.5L291.3,188.3z M296.7,192.1l-0.9-3.6l-2.3-9l29.9-7.5
			l18.4,14.1l-2,15.5l-27.3,0.6L296.7,192.1z M352.5,192l-9.5,7.7l1.7-13.5l17-17.5L352.5,192z"/>
		</svg>
  </div>
</template>

<script lang="ts">
import { Vue, Component, Prop, Watch } from 'vue-property-decorator'
import throttle from 'lodash/throttle'

@Component
export default class Eye extends Vue {
  @Prop({ required: true })
	reference: HTMLElement | null

  eye: HTMLElement | null = null
  pupil: HTMLElement | null = null

  @Watch('reference', { immediate: true })
	onReferenceChanged () {
    if (this.reference) {
      this.eye = this.$refs.eye as HTMLElement
      this.pupil = this.$refs.pupil as HTMLElement

      this.reference.addEventListener('mousemove', throttle((e: MouseEvent) => {
        let x: number = (e.x - window.innerWidth / 2) / 50
        let y: number = (e.y - (window.innerHeight + 60) / 2) / 50

        let xMax = 25
        let yMax = 30
        x = x > xMax ? xMax : x
        x = x < -xMax ? -xMax : x
        y = y > yMax ? yMax : y
        y = y < -yMax ? -yMax : y

        if (this.eye) {
          this.eye.setAttribute('style', `transform: translate3d(${-x}px, ${-y}px, 0)`)
        }
        if (this.pupil) {
          this.pupil.setAttribute('style', `transform: translate3d(${ x / 5 }px, ${ y / 5 }px, 0)`)
        }
      }, 30))
    }
  }
}
</script>

<style scoped>
  svg {
    position: relative;
		width: 500px;
    left: 50%;
    top: 50%;
    transform: translate3d(-50%, -50%, 0);
  }

  .eye {
    overflow-x: hidden;
  }

	.st0{fill:#FFFFFF;}
	.st1{fill:#F7B78D;}
	.st2{fill:#203451;}
	.st3{fill:#113350;}
</style>